---
title: "ã‚¹ãƒžãƒ›ã§ã‚³ãƒ¼ãƒ‰æ›¸ã ç’°å¢ƒæ§‹ç¯‰ç·¨2"
emoji: "ðŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Linux"]
published: false
---

ã‚¹ãƒžãƒ›ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ„ç¾©ã€ãã‚Œã¯ä¸»ã«ãƒ†ã‚¯ãƒŽãƒ­ã‚¸ãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šã«ã‚ã‚Šã¾ã™ã€‚ã‚¹ãƒžãƒ›ã¯æ—¢ã«æ—¥æœ¬äººã«ã¨ã£ã¦æœ€ã‚‚é¦´æŸ“ã¿ã®ã‚ã‚‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ‡ãƒã‚¤ã‚¹ã§ã™ã€‚ãã®ä¸Šã§æ§˜ã€…ãªãƒ†ã‚¯ãƒŽãƒ­ã‚¸ãƒ¼ã«ç„¡æ–™ã§è§¦ã‚Œã‚‹ã§ãã‚Œã°ã©ã‚Œã»ã©ã®ä¾¡å€¤ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚

## golangã‚’ä½¿ã†

ã€Œç§»æ¤æ€§ã®é«˜ã„æœ€è¿‘ã®è¨€èªžã¨ã„ãˆã°goã€‚ã€ã¨ã„ã†å®‰ç›´ãªç†ç”±ã§ã€ã‚¹ãƒžãƒ›ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãéš›ã«ã‚‚goã‚’æŽ¡ç”¨ã—ã¾ã™ã€‚è‰¯ãã‚‚æ‚ªãã‚‚åŸºæœ¬çš„ãªé“å…·ã—ã‹ãªã„ã®ã§ã€å®Ÿé¨“çš„ãªå­¦ç¿’ç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚ãƒ”ãƒƒã‚¿ãƒªãªè¨€èªžã ã¨æ€ã„ã¾ã™ã€‚

Ubuntuã®goã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¤ã„ãŸã‚ã€å…¬å¼ã‹ã‚‰æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

https://golang.org/dl/

```bash
wget https://golang.org/dl/go1.16.6.linux-arm64.tar.gz
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯è§£å‡ã—ã¦é…ç½®ã™ã‚‹ã ã‘ã§ã™ã€‚

```bash
tar -C /usr/local -xzf go1.16.6.linux-arm64.tar.gz
```

`.bashrc`ã§ãƒ‘ã‚¹ã‚’è¿½è¨˜ã—ã¾ã™ã€‚

```bash
export PATH=$PATH:/usr/local/go/bin
```

## node.jsã©ã†ã™ã‚‹ã‹å•é¡Œ

ã“ã‚Œã¾ã§ã®ã‚¹ãƒžãƒ›ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®é–‹ç™ºã§ã¯ã€node.jsã©ã†ã™ã‚‹ã‹å•é¡ŒãŒå¸¸ã«ã¤ãã¾ã¨ã£ã¦ã„ã¾ã—ãŸãŒã€ã“ã®å•é¡Œã¯node.jsã®ARMå¯¾å¿œãŒæ€¥é€Ÿã«æ”¹å–„ã•ã‚Œã‚‹ã¨ã„ã†å½¢ã§ç¾åœ¨ã§ã¯ã»ã¼è§£æ±ºã—ã¦ã„ã¾ã™ã€‚16ç³»ã§ã¯Appleã®M1å‘ã‘ã®ãƒã‚¤ãƒŠãƒªãŒæä¾›ã•ã‚Œã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰ã®ã‚ˆã‚Šå¤šãã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¾—ã¦æ”¹å–„ãŒé€²ã‚€ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã¾ã™ã€‚

ä»Šå›žã¯14ç³»ã®æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚Ubuntuã®nodejsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå¾Œã€node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼nã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦14ç³»ã®æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
sudo apt install nodejs npm
npm i -g n
n i 14.17.3
```

## MongoDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯å…¬å¼ãƒšãƒ¼ã‚¸ã§ARMå¯¾å¿œã‚’è¬³ã£ã¦ã„ã‚‹MongoDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ã‚¹ã‚­ãƒ¼ãƒžãƒ¬ã‚¹æœ€é«˜ï¼å··ã§ã¯ç‰©è­°ã‚’é†¸ã—ãŒã¡ãªMongoDBã§ã™ãŒè‡ªåˆ†ã¯çµæ§‹å¥½ãã§ã™ã€‚è¿‘å¹´ã§ã¯ãƒžãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚‚å……å®Ÿã—ã¦ãã¦ã„ã¾ã™ã€‚

MongoDBã¯åˆå¿ƒè€…å‘ã‘ã¨ã„ã†ã‚ã‘ã§ã¯ãªã„ã§ã™ã€‚å°‘ãªãã¨ã‚‚æ¥­å‹™ã§æŠ•å…¥ã™ã‚‹ä¸Šã§ã¯æ§˜ã€…ãªè½ã¨ã—ç©´ã«æ³¨æ„ã‚’æ‰•ã†å¿…è¦ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã‚ªã‚¹ã‚¹ãƒ¡ã‚’ã™ã‚‹ã‚ã‘ã§ã¯ãªã„ã¨ã„ã†ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/

ARMç‰ˆUbuntuå‘ã‘ã®ãƒªãƒã‚¸ãƒˆãƒªãŒã‚ã‚‹ã®ã§ãã“ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯5.0.0ã§ã™ã€‚

```bash
echo "deb [ arch=arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/5.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-5.0.list
sudo apt-get update
sudo apt-get install -y mongodb-org
```

ã‚³ãƒ³ãƒ•ã‚£ã‚°ã‚’æ›¸ãã¾ã™ã€‚é–‹ç™ºç’°å¢ƒã§ã¯DBã®ä¸­èº«ã‚’å…¨ã¦æ¶ˆã™ã“ã¨ã‚‚ã‚ã‚Šå¾—ã‚‹ã®ã§æ‰±ã„ã‚„ã™ã„ä½ç½®ã«dbãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç½®ããã“ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```yaml
storage:
   dbPath: /home/sigma/develop/hello_task/mongodb/db
systemLog:
   destination: file
   path: /home/sigma/develop/hello_task/mongodb/log/mongod.log
   logAppend: true
```

ãƒ­ã‚°ã‚’æ¼ã‚‹ã“ã¨ã¯å°‘ãªã„ã¨æ€ã„ã¾ã™ãŒã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ä½œã•ã›ã‚‹ã®ã«å¿…è¦ãªã®ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’è€ƒãˆã¾ã™ã€‚ã¾ãšä½œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®åå‰ã‚’æ±ºã‚ã¾ã™ã€‚todoã‚¢ãƒ—ãƒªã‚’æ‹¡å¼µã™ã‚‹ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã§ä½œã£ã¦è¡Œãã®ã§`hello_task`ã¨ã„ã†åå‰ã‚’ã¤ã‘ã¾ã™ã€‚

```bash
hello_task$ tree -L 2
```

```
.
â”œâ”€â”€ backend
â”‚Â Â  â”œâ”€â”€ controller
â”‚Â Â  â”œâ”€â”€ go.mod
â”‚Â Â  â”œâ”€â”€ go.sum
â”‚Â Â  â”œâ”€â”€ main.go
â”‚Â Â  â”œâ”€â”€ repository
â”‚Â Â  â””â”€â”€ service
â”œâ”€â”€ devscript
â”‚Â Â  â”œâ”€â”€ close.sh
â”‚Â Â  â””â”€â”€ start.sh
â”œâ”€â”€ frontend
â”‚Â Â  â”œâ”€â”€ README.md
â”‚Â Â  â”œâ”€â”€ assets
â”‚Â Â  â”œâ”€â”€ components
â”‚Â Â  â”œâ”€â”€ jest.config.js
â”‚Â Â  â”œâ”€â”€ jsconfig.json
â”‚Â Â  â”œâ”€â”€ layouts
â”‚Â Â  â”œâ”€â”€ node_modules
â”‚Â Â  â”œâ”€â”€ nuxt.config.js
â”‚Â Â  â”œâ”€â”€ package-lock.json
â”‚Â Â  â”œâ”€â”€ package.json
â”‚Â Â  â”œâ”€â”€ pages
â”‚Â Â  â”œâ”€â”€ static
â”‚Â Â  â”œâ”€â”€ store
â”‚Â Â  â”œâ”€â”€ test
â”‚Â Â  â””â”€â”€ tsconfig.json
â””â”€â”€ mongodb
    â”œâ”€â”€ db
    â”œâ”€â”€ log
    â””â”€â”€ mongod.yaml

17 directories, 13 files
```

frontendã¨backendã«åˆ†ã‘ã¾ã™ã€‚ãã‚Œãžã‚Œåˆ¥ã®gitãƒªãƒã‚¸ãƒˆãƒªã¨ã—ã¦ç®¡ç†ã—ã¾ã™ã€‚frontendã¯nuxtã‚’ä½¿ã†ã®ã§ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚‚nuxtã«å¾“ã„ã¾ã™ã€‚backendã¯ã‚·ãƒ³ãƒ—ãƒ«ã«controller service repositoryã«åˆ‡ã‚Šåˆ†ã‘ã¾ã™ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã¯å¯èƒ½ãªé™ã‚Šserviceã«å‡é›†ã—ã¾ã™ã€‚

MongoDBã®å®Ÿä½“ã‚„ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ãªã©æ ¼ç´ã‚’æ ¼ç´ã™ã‚‹mongodbãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æº–å‚™ã—ã¾ã™ã€‚

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

æœ€å¾Œã«èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãã¾ã™ã€‚devscriptã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ‡ã‚Šã¾ã™ã€‚

```bash
DEVDIR=~/develop/hello_task
source $DEVDIR/devscript/close.sh
tmux new-window -d -n nuxt -c $DEVDIR/frontend "npm run dev"
mongod --fork --config $DEVDIR/mongodb/mongod.yaml >> /dev/null
tmux new-window -d -n gin -c $DEVDIR/backend "go run main.go"
```

```bash
tmux kill-window -t nuxt
tmux kill-window -t gin
mongo --eval "db.getSiblingDB('admin').shutdownServer()" >> /dev/null
```

